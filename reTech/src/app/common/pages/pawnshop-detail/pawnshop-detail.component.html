<div class="container-fluid mt-3">
    <div class="row justify-content-center">
        <div class="col-12">
            <div class="profile-header d-flex align-items-start p-3 mb-3" *ngIf="pawnShop$| async as profile; else notLoggedIn">
                <!-- Pawnshop Logo -->
                <div class="avatar-img me-4">
                    <img [src]="profile?.logoUrl || 'assets/png/default-pawnshop.jpg'"
                        alt="pawnshop-logo"
                        class="rounded-circle me-3"
                        width="190"
                        height="190" />
                    
                </div>

                <!-- Pawnshop Info -->
                <div class="flex-grow-1 ms-5 profile-info" *ngIf="profile">

                    <div class="info-block">
                        <div class="d-flex align-items-center flex-wrap gap-5">
                        <!-- –ù–∞–∑–≤–∞–Ω–∏–µ -->
                        <h3 class="mb-0 me-3">{{ profile?.name || 'Pawnshop name' }}</h3>

                        <!-- üïí –í—Ä–µ–º—è -->
                        <p class="text-muted mb-0 small fw-semibold d-flex align-items-center">
                            <i class="fa-regular fa-clock me-1"></i>
                            {{ profile?.openTime }} ‚Äì {{ profile?.closeTime }}
                            <span
                            [ngClass]="{
                                'text-success': isOpenNow,
                                'text-danger': !isOpenNow
                            }"
                            class="ms-2 fw-bold"
                            >
                            {{ isOpenNow ? '–û—Ç–∫—Ä—ã—Ç–æ' : '–ó–∞–∫—Ä—ã—Ç–æ' }}
                            </span>
                        </p>

                        <!-- ‚è∞ –¢–µ–∫—É—â–µ–µ –≤—Ä–µ–º—è -->
                        <p class="text-muted mb-0 small fw-semibold d-flex align-items-center">
                            <i class="fa-regular fa-clock me-1"></i>
                            {{ currentTime | date:'shortTime' }}
                        </p>

                        <!-- ‚≠ê –†–µ–π—Ç–∏–Ω–≥ -->
                        <div class="d-flex align-items-center">
                            <ng-container *ngFor="let star of [1, 2, 3, 4, 5]">
                            <i
                                class="fa-star"
                                [ngClass]="{
                                'fa-solid text-warning': profile.rating >= star,
                                'fa-regular text-muted': profile.rating < star
                                }"
                                style="font-size: 16px; margin-right: 3px;"
                            ></i>
                            </ng-container>
                        </div>
                        </div>
                        <hr class="my-4 divider-custom" />
                    </div>

                    <!-- –û–ø–∏—Å–∞–Ω–∏–µ -->
                    <div class="description-block mt-4">
                        <h6 class="fw-semibold mb-2">
                        <i class="fa-regular fa-file-lines me-2 text-primary"></i>
                        –û –Ω–∞—Å
                        </h6>
                        <p class="text-muted mb-0">
                        {{ profile?.description || '–û–ø–∏—Å–∞–Ω–∏–µ –ø–æ–∫–∞ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç' }}
                        </p>
                    </div>
                </div>



            </div>

            <ng-template #notLoggedIn>
                <div class="alert alert-warning d-flex align-items-center p-4 mb-3" role="alert">
                <i class="fa-solid fa-profile-lock me-3 fs-4"></i>
                <div>
                    <h5 class="mb-1 fw-bold">{{ 'You are not logged in' | translate }}</h5>
                    <p class="mb-0">
                    {{ 'Please' | translate }}
                    <a routerLink="/login" class="text-primary fw-semibold">{{ 'log in' | translate }}</a>
                    {{ 'or' | translate }}
                    <a routerLink="/register" class="text-primary fw-semibold">{{ 'register' | translate }}</a>.
                    </p>
                </div>
                </div>
            </ng-template>
        </div>

        <div class="row align-itemms-stretch mt-4">
            <!-- –§–û–¢–û –õ–û–ú–ë–ê–†–î–ê -->
            <div class="col-lg-4 col-md-6 mb-4">
                <div class="image-gallery" *ngIf="pawnShop$ | async as profile; else notLoggedIn">
                <h5 class="fw-semibold mb-3">
                    <i class="fa-regular fa-images me-2 text-primary"></i>
                    –§–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏ –ª–æ–º–±–∞—Ä–¥–∞
                </h5>

                <div class="gallery-grid">
                    <div *ngFor="let photo of profile.photos" class="gallery-item">
                    <img [src]="photo" alt="–§–æ—Ç–æ –ª–æ–º–±–∞—Ä–¥–∞" />
                    </div>
                </div>
                </div>
            </div>

            <!-- –¢–û–í–ê–†–´ –õ–û–ú–ë–ê–†–î–ê -->
           <div class="col-lg-8 col-md-6 mb-4">
            <div class="pawnshop-products" *ngIf="products$ | async as products">
                <h5 class="fw-semibold mb-3">
                    <i class="fa-solid fa-box-open me-2 text-primary"></i>
                    –¢–æ–≤–∞—Ä—ã –ª–æ–º–±–∞—Ä–¥–∞ –Ω–∞ –ø—Ä–æ–¥–∞–∂–µ
                </h5>

                <div *ngIf="products.length > 0; else noProducts" class="product-container">
                    <div class="mb-3" *ngFor="let product of products">
                        <div class="product-card" (click)="openProductDetail(product)" style="position: relative;">
                            <img [src]="[product.photos[0]]" alt="main-photo" class="main-photo">
    
                            <i 
                                class="fa-heart" 
                                style="position: absolute; top: 10px; right: 10px; font-size: 1.6rem; cursor: pointer;"
                                [ngClass]="{
                                    'fa-solid text-danger': user?.favoriteItems?.includes(product._id),
                                    'fa-regular text-white': !user?.favoriteItems?.includes(product._id)
                                }"
                                (click)="toggleFavoriteItem(product._id, $event)">
                                </i>

                            <div class="info-block">
                                <span>{{product.title}}</span>
                                <span class="mt-2">{{product.price}} –¢–≥</span>
                            </div>
                        </div>
                    </div>
                </div>

                <ng-template #noProducts>
                    <p class="text-muted">–ü–æ–∫–∞ –Ω–µ—Ç —Ç–æ–≤–∞—Ä–æ–≤ –Ω–∞ –ø—Ä–æ–¥–∞–∂–µ</p>
                </ng-template>
            </div>
           </div>




        </div>


    </div>
</div>